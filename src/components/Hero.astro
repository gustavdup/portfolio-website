---
import { getEntryBySlug, getCollection } from 'astro:content';
import EducationSection from './EducationSection.astro';

const bio = await getEntryBySlug('bio', 'bio');

// Get featured projects
const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter(project => project.data.featured)
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999));
---

<div class="max-w-4xl mx-auto mt-8">
  <!-- Main Hero Section -->
  <div class="flex items-start gap-8 mb-12">
    <!-- Profile Image -->
    <div class="relative w-32 h-32 rounded-full overflow-hidden flex-shrink-0 border border-gray-200 dark:border-gray-700">
      <img 
        src="/Profile.jpg" 
        alt="Gustav du Plessis" 
        class="w-full h-full object-cover"
        onerror="this.src='/profile-placeholder.svg'"
      />
    </div>
    
    <!-- Hero Content -->
    <div class="flex-1">
      <h1 class="text-base md:text-lg lg:text-xl font-normal text-text-light dark:text-text-dark leading-relaxed mb-6">
        Hey, I'm Gustav. I build, design, and create digital experiences that matter. 
        <span class="text-gray-600 dark:text-gray-400">Based in South Africa.</span>
        {bio?.data.email && (
          <a href={`mailto:${bio.data.email}`} class="group inline-flex items-center ml-3 text-primary hover:text-primary-600 transition-colors">
            <span class="font-medium border-b border-primary/30 hover:border-primary transition-colors">Say hello</span>
            <span class="ml-1 opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all duration-300">
              <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4" xmlns="http://www.w3.org/2000/svg">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </span>
          </a>
        )}
      </h1>
    </div>
  </div>

  <!-- Work Section -->
  <section class="mb-16">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-lg font-medium text-text-light dark:text-text-dark tracking-wide uppercase">Work</h2>
      <a href="/experience" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary transition-colors flex items-center gap-1 group">
        <span>Previous roles</span>
        <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3 h-3 opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all duration-300" xmlns="http://www.w3.org/2000/svg">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </a>
    </div>
    <div class="space-y-4">
      <div class="flex justify-between items-start py-3 border-b border-gray-200 dark:border-gray-700">
        <div>
          <h3 class="font-medium text-text-light dark:text-text-dark">Senior Product Manager</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Current Role</p>
        </div>
        <div class="text-right">
          <p class="text-gray-600 dark:text-gray-400 text-sm">2024 - Present</p>
          <p class="text-gray-500 dark:text-gray-500 text-sm">Company Name</p>
        </div>
      </div>
    </div>
  </section>

  <!-- What I Do Section -->
  <section class="mb-16">
    <h2 class="text-lg font-medium text-text-light dark:text-text-dark mb-6 tracking-wide uppercase">What I Do</h2>
    <div class="prose prose-gray dark:prose-invert max-w-none">
      <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
        Started out learning how to code. Got obsessed with building great products and experiences.
        Now I focus on product management and design, helping teams build the right things, the right way.
        On the side, I create digital tools and experiments. I care about clean design, user experience,
        and the kind of products that make people's lives better.
      </p>
    </div>
  </section>

  <!-- Education Section -->
  <EducationSection />

  <!-- Featured Projects Section -->
  <section class="mb-16">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-lg font-medium text-text-light dark:text-text-dark tracking-wide uppercase">Featured Projects</h2>
      <a href="/projects" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary transition-colors flex items-center gap-1 group">
        <span>View Portfolio</span>
        <svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="w-3 h-3 opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all duration-300" xmlns="http://www.w3.org/2000/svg">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </a>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {featuredProjects.map(project => (
        <a href={`/projects/${project.slug}`} class="group block p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-primary/30 dark:hover:border-primary/30 transition-all duration-200 hover:shadow-sm">
          <h3 class="font-medium text-text-light dark:text-text-dark group-hover:text-primary transition-colors">{project.data.title}</h3>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">{project.data.summary}</p>
          {project.data.tags && project.data.tags.length > 0 && (
            <div class="flex flex-wrap gap-1 mt-2">
              {project.data.tags.slice(0, 3).map(tag => (
                <span class="inline-block bg-primary/10 text-primary text-xs px-2 py-1 rounded">
                  {tag}
                </span>
              ))}
              {project.data.tags.length > 3 && (
                <span class="text-xs text-gray-500 dark:text-gray-400">+{project.data.tags.length - 3} more</span>
              )}
            </div>
          )}
        </a>
      ))}
    </div>
  </section>
</div>
